@echo off
setlocal
REM 
REM Path to WinRAR executable in Program Files. Change if location is different
REM ---------------------- WinRAR Directory ------------------------------------------------------------------------------
set rardirectory="C:\Program Files\WinRAR\Rar.exe"
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Par2 Directory --------------------------------------------------------------------------------
set par2directory="C:\Users\Martin\Desktop\Usenet_Programms\ngPost_photo\par2.exe"
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- SFV Directory ---------------------------------------------------------------------------------
set sfvdirectory="C:\Users\Martin\Desktop\Usenet_Programms\ngPost_photo\quicksfv.exe"
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Source Directory ------------------------------------------------------------------------------
echo [91m"Source Path"
set /p source=" "[0m
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Folder Name -----------------------------------------------------------------------------------
echo [95m"Folder Name"
set /p foldername=" "[0m
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Arcive Name -----------------------------------------------------------------------------------
echo [92m"Arcive Name"
set /p archivename=" "[0m
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Arcive Password -------------------------------------------------------------------------------
echo [94m"Arcive Password"
set /p archivepassword=" "[0m
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Destination Directory -------------------------------------------------------------------------
echo [96m"Destination Path"[0m
set destination="C:\Users\Martin\Desktop\Usenet_Programms\ngPost_photo\tmp\%foldername%"
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Check Directory -------------------------------------------------------------------------------
if exist %destination% rmdir %destination% /s /q
REM
if not exist %destination% mkdir %destination%
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ----------------------------------------------------------------------------------------------------------------------
powershell -f C:\Users\Martin\Desktop\Usenet_Programms\ngPost_apps\List_all_files.ps1 %source% %destination% %archivename%
REM ----------------------------------------------------------------------------------------------------------------------
REM
REM ---------------------- Changing to a directory -----------------------------------------------------------------------
cd %destination%
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Create rar files ------------------------------------------------------------------------------
echo [90m"Create rar files"[0m
%rardirectory% a -ep1 -r -idp -m0 -v100m -p%archivepassword% %destination%\%archivename% %source% >> C:\Users\Martin\Desktop\Usenet_Programms\ngPost_photo\tmp\%archivename%.log
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Create par2 files -----------------------------------------------------------------------------
echo [90m"Create par2 files"[0m
%par2directory% c -l -q -m1024 -r25 %destination%\%archivename% %destination%\%archivename%*.rar
REM ----------------------------------------------------------------------------------------------------------------------
REM 
REM ---------------------- Create sfv file -------------------------------------------------------------------------------
echo [90m"Create sfv file"[0m
%sfvdirectory% -c %archivename%.sfv *.*
REM ----------------------------------------------------------------------------------------------------------------------
REM 
endlocal
pause
REM 
REM --------------------------- exit -------------------------------------------------------------------------------------
REM 
EXIT /B 0
